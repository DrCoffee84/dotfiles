!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=66)}({66:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,c){function o(e){try{s(r.next(e))}catch(e){c(e)}}function f(e){try{s(r.throw(e))}catch(e){c(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,f)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:f(0),throw:f(1),return:f(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function f(c){return function(f){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,f])}}},c=[{name:"Missing fields",data:{"7733be61632fa6af88d31218e6c4afb2":{secret:"abcd2345"}}},{name:"Bad hash in key",data:{badhash:{account:"test",counter:0,encrypted:!1,hash:"7733be61632fa6af88d31218e6c4afb2",index:0,issuer:"",secret:"abcd2345",type:"totp"}}},{name:"Bad hash",data:{badhash:{account:"test",counter:0,encrypted:!1,hash:"badhash",index:0,issuer:"",secret:"abcd2345",type:"totp"}}},{name:"Bad type for HEX",data:{e19d5cd5af0378da05f63f891c7467af:{account:"test",counter:0,encrypted:!1,hash:"e19d5cd5af0378da05f63f891c7467af",index:0,issuer:"",secret:"abcd1234",type:"totp"}}},{name:"Unicode in issuer",data:{"7733be61632fa6af88d31218e6c4afb2":{account:"test",counter:0,encrypted:!1,hash:"7733be61632fa6af88d31218e6c4afb2",index:0,issuer:"✓ à la mode",secret:"abcd2345",type:"totp"}}},{name:"Battle migrate",data:{"95c869de1221960c7f7e6892f78d7062":{account:"test",counter:0,encrypted:!1,hash:"95c869de1221960c7f7e6892f78d7062",index:0,issuer:"",secret:"blz-abcd2345",type:"totp"}}},{name:"Steam migrate",data:{"95c869de1221960c7f7e6892f78d7062":{account:"test",counter:0,encrypted:!1,hash:"95c869de1221960c7f7e6892f78d7062",index:0,issuer:"",secret:"stm-abcd2345",type:"totp"}}},{name:"Missing field with HEX secret",data:{e19d5cd5af0378da05f63f891c7467af:{secret:"abcd1234"}}},{name:"Mess index",data:{"7733be61632fa6af88d31218e6c4afb2":{account:"test",counter:0,encrypted:!1,hash:"7733be61632fa6af88d31218e6c4afb2",index:6,issuer:"",secret:"abcd2345",type:"totp"},"770f51f23603ddae810e446630c2f673":{account:"test",counter:0,encrypted:!1,hash:"770f51f23603ddae810e446630c2f673",index:6,issuer:"",secret:"abcd2346",type:"totp"}}},{name:"Base32 with padding",data:{b905232a977347a0a113a7d1c924fb8d:{account:"test",counter:0,encrypted:!1,hash:"b905232a977347a0a113a7d1c924fb8d",index:0,issuer:"",secret:"DKCE3SQPHJRJQGBGI322QA7Z5E======",type:"totp"}}},{name:"Incorrect but valid hash",data:{ffffffffffffffffffffffffffffffff:{account:"test",counter:0,encrypted:!1,hash:"ffffffffffffffffffffffffffffffff",index:0,issuer:"",secret:"abcd2345",type:"totp"}}},{name:"HOTP with HEX secret",data:{"7c117a118e015b6232ff359958b9e270":{account:"test",counter:0,encrypted:!1,hash:"7c117a118e015b6232ff359958b9e270",index:0,issuer:"",secret:"2c52e8fcfac34091da63ef7b118f1cc50b925a42",type:"hhex"}}},{name:"Amazon 2FA",data:{"0e00b601f60a4d7154d54ba94c429afb":{account:"test",counter:0,encrypted:!1,hash:"0e00b601f60a4d7154d54ba94c429afb",index:0,issuer:"",secret:"QLGNXJ2KLSOACXOEKJ47X6VA6ZPGT5HE2GBO5NPXTLD7FJAKD4JQ",type:"totp"}}},{name:"Secret contains spaces",data:{"1b0c21ad1ec44264f665708ef82dae84":{account:"test",counter:0,encrypted:!1,hash:"1b0c21ad1ec44264f665708ef82dae84",index:0,issuer:"",secret:"p5s7 k2in z3mj oqfg",type:"totp"}}}],o=0,f=[],s=[];function i(){return r(this,void 0,void 0,(function(){return a(this,(function(e){return[2,new Promise((function(e,t){try{chrome.storage.sync.clear(e)}catch(e){t(e)}}))]}))}))}function d(){return r(this,void 0,void 0,(function(){return a(this,(function(e){return[2,new Promise((function(e,t){try{chrome.storage.sync.get(e)}catch(e){t(e)}}))]}))}))}function u(e){return r(this,void 0,void 0,(function(){return a(this,(function(t){return[2,new Promise((function(t,n){try{chrome.storage.sync.set(e,t)}catch(e){n(e)}}))]}))}))}var l=document.getElementById("start");l&&(l.onclick=function(){if(document.getElementById("lock")&&!document.getElementById("lock").checked)return;var e=document.getElementById("start");e&&e.setAttribute("disabled","true"),o=0,f=[],function e(){return r(this,void 0,void 0,(function(){var t,n=this;return a(this,(function(l){switch(l.label){case 0:return o===2*c.length?(function(){i(),console.log("Test finished.");for(var e=0,t=f;e<t.length;e++){if(!t[e].pass)return void alert("Test failed!")}alert("Test passed!")}(),[2]):(console.log(c[Math.floor(o/2)].name,o%2?"Reopen":""),o%2!=0?[3,2]:(i(),[4,u(c[Math.floor(o/2)].data)]));case 1:l.sent(),l.label=2;case 2:return(t=document.getElementsByTagName("iframe")[0])&&(f[o]={pass:!0,error:""},t.src="popup.html",t.onload=function(){t.contentWindow&&(t.contentWindow.addEventListener("unhandledrejection",(function(e){var t=e;f[o]={pass:!1,error:t.reason}})),t.contentWindow.onerror=function(e){f[o]={pass:!1,error:e}})}),setTimeout((function(){return r(n,void 0,void 0,(function(){var n,r,i,u,l,h,p,b;return a(this,(function(a){switch(a.label){case 0:return[4,d()];case 1:if(n=a.sent(),s[o]=JSON.stringify(n,null,2),f[o].pass)if(Object.keys(n).length!==Object.keys(c[Math.floor(o/2)].data).length)f[o]={pass:!1,error:"Missing data"};else for(r=0,i=Object.keys(n);r<i.length;r++)for(u=i[r],l=n[u],h=0,p=["issuer","account","secret","hash","index","type","counter","encrypted"];h<p.length;h++)if(void 0===l[b=p[h]]){f[o]={pass:!1,error:"Missing key<"+b+">: "+JSON.stringify(l)};break}return function(){var e=document.getElementById("test");if(!e)return;e.innerHTML="";for(var t=0;t<f.length;t++){var n=document.createElement("tr");n.innerHTML='<td style="vertical-align: text-top; width: 50px; color: '+(f[t].pass?"green":"red")+'">['+(f[t].pass?"Pass":"Fail")+"]</td>",n.innerHTML+='<td><h3 style="margin: 0">'+c[Math.floor(t/2)].name+(t%2==1?" (Reopen)":"")+"</h3>"+f[t].error+"<br><pre><code>"+s[t]+"</code></pre><br></td>",e.appendChild(n)}}(),o++,document.getElementsByTagName("iframe")&&t&&(t.src="about:blank"),[4,e()];case 2:return a.sent(),[2]}}))}))}),1e3),[2]}}))}))}()}),window.addEventListener("message",(function(e){f[o]={pass:!1,error:e.data}}),!1)}});
//# sourceMappingURL=test.js.map